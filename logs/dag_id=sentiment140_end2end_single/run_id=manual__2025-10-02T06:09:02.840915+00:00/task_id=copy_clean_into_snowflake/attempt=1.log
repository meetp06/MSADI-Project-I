[2025-10-02T06:09:51.058+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-10-02T06:09:51.065+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sentiment140_end2end_single.copy_clean_into_snowflake manual__2025-10-02T06:09:02.840915+00:00 [queued]>
[2025-10-02T06:09:51.068+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sentiment140_end2end_single.copy_clean_into_snowflake manual__2025-10-02T06:09:02.840915+00:00 [queued]>
[2025-10-02T06:09:51.068+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-10-02T06:09:51.075+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): copy_clean_into_snowflake> on 2025-10-02 06:09:02.840915+00:00
[2025-10-02T06:09:51.079+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=598) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-10-02T06:09:51.080+0000] {standard_task_runner.py:63} INFO - Started process 600 to run task
[2025-10-02T06:09:51.080+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'sentiment140_end2end_single', 'copy_clean_into_snowflake', 'manual__2025-10-02T06:09:02.840915+00:00', '--job-id', '56', '--raw', '--subdir', 'DAGS_FOLDER/edaproject.py', '--cfg-path', '/tmp/tmph4y_inx0']
[2025-10-02T06:09:51.081+0000] {standard_task_runner.py:91} INFO - Job 56: Subtask copy_clean_into_snowflake
[2025-10-02T06:09:51.098+0000] {task_command.py:426} INFO - Running <TaskInstance: sentiment140_end2end_single.copy_clean_into_snowflake manual__2025-10-02T06:09:02.840915+00:00 [running]> on host b4099255ca46
[2025-10-02T06:09:51.126+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sentiment140_end2end_single' AIRFLOW_CTX_TASK_ID='copy_clean_into_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2025-10-02T06:09:02.840915+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-02T06:09:02.840915+00:00'
[2025-10-02T06:09:51.126+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-10-02T06:09:51.140+0000] {base.py:84} INFO - Using connection ID 'aws_default' for task execution.
[2025-10-02T06:09:51.141+0000] {connection_wrapper.py:384} INFO - AWS Connection (conn_id='aws_default', conn_type='aws') credentials retrieved from login and password.
[2025-10-02T06:09:51.149+0000] {base.py:84} INFO - Using connection ID 'snowflake_default' for task execution.
[2025-10-02T06:09:51.149+0000] {connection.py:399} INFO - Snowflake Connector for Python Version: 3.10.0, Python Version: 3.12.3, Platform: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[2025-10-02T06:09:51.150+0000] {connection.py:1239} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-10-02T06:09:52.674+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2025-10-02T06:09:52.674+0000] {sql.py:470} INFO - Running statement: USE WAREHOUSE COMPUTE_WH;, parameters: None
[2025-10-02T06:09:52.892+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2025-10-02T06:09:52.893+0000] {sql.py:479} INFO - Rows affected: 1
[2025-10-02T06:09:52.893+0000] {snowflake.py:407} INFO - Rows affected: 1
[2025-10-02T06:09:52.893+0000] {snowflake.py:408} INFO - Snowflake query id: 01bf6f51-0306-8f88-0000-00131e67d1a1
[2025-10-02T06:09:52.893+0000] {sql.py:470} INFO - Running statement: USE ROLE ACCOUNTADMIN;, parameters: None
[2025-10-02T06:09:53.028+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2025-10-02T06:09:53.029+0000] {sql.py:479} INFO - Rows affected: 1
[2025-10-02T06:09:53.029+0000] {snowflake.py:407} INFO - Rows affected: 1
[2025-10-02T06:09:53.029+0000] {snowflake.py:408} INFO - Snowflake query id: 01bf6f51-0306-904a-0000-00131e676121
[2025-10-02T06:09:53.030+0000] {sql.py:470} INFO - Running statement: USE DATABASE YOUR_DB;, parameters: None
[2025-10-02T06:09:53.121+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2025-10-02T06:09:53.122+0000] {sql.py:479} INFO - Rows affected: 1
[2025-10-02T06:09:53.123+0000] {snowflake.py:407} INFO - Rows affected: 1
[2025-10-02T06:09:53.123+0000] {snowflake.py:408} INFO - Snowflake query id: 01bf6f51-0306-8f88-0000-00131e67d1a5
[2025-10-02T06:09:53.124+0000] {sql.py:470} INFO - Running statement: USE SCHEMA PUBLIC;, parameters: None
[2025-10-02T06:09:53.713+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2025-10-02T06:09:53.714+0000] {sql.py:479} INFO - Rows affected: 1
[2025-10-02T06:09:53.715+0000] {snowflake.py:407} INFO - Rows affected: 1
[2025-10-02T06:09:53.716+0000] {snowflake.py:408} INFO - Snowflake query id: 01bf6f51-0306-9226-0000-00131e67b165
[2025-10-02T06:09:53.716+0000] {sql.py:470} INFO - Running statement: 
    COPY INTO YOUR_DB.PUBLIC.SENTIMENT140_CLEAN
    FROM 's3://298a1/sentiment140/cleaned/20251002T060913Z/'
    CREDENTIALS=(AWS_KEY_ID='AKIA6FAWABT26ZPML6YE' AWS_SECRET_KEY='***')
    FILE_FORMAT = (TYPE=CSV FIELD_OPTIONALLY_ENCLOSED_BY='"' SKIP_HEADER=1 COMPRESSION=AUTO)
    PATTERN='.*';
    , parameters: None
[2025-10-02T06:09:55.512+0000] {connection.py:762} INFO - closed
[2025-10-02T06:09:55.597+0000] {connection.py:768} INFO - No async queries seem to be running, deleting session
[2025-10-02T06:09:55.699+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-10-02T06:09:55.699+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/edaproject.py", line 359, in _copy_clean_into_snowflake
    sf.run([
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 395, in run
    self._run_command(cur, sql_statement, parameters)  # type: ignore[attr-defined]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py", line 475, in _run_command
    cur.execute(sql_statement)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/cursor.py", line 1080, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 100016 (22000): 01bf6f51-0306-908d-0000-00131e678149: Field delimiter ',' found while expecting record delimiter '\n'
  File 'sentiment140/cleaned/20251002T060913Z/MAUD_train_cleaned.csv', line 189387, character 2
  Row 189385 starts at line 189386, column "SENTIMENT140_CLEAN"["TEXT":2]
  If you would like to continue loading when an error is encountered, use other values such as 'SKIP_FILE' or 'CONTINUE' for the ON_ERROR option. For more information on loading options, please run 'info loading_data' in a SQL client.
[2025-10-02T06:09:55.703+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=sentiment140_end2end_single, task_id=copy_clean_into_snowflake, run_id=manual__2025-10-02T06:09:02.840915+00:00, execution_date=20251002T060902, start_date=20251002T060951, end_date=20251002T060955
[2025-10-02T06:09:55.708+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 56 for task copy_clean_into_snowflake (100016 (22000): 01bf6f51-0306-908d-0000-00131e678149: Field delimiter ',' found while expecting record delimiter '\n'
  File 'sentiment140/cleaned/20251002T060913Z/MAUD_train_cleaned.csv', line 189387, character 2
  Row 189385 starts at line 189386, column "SENTIMENT140_CLEAN"["TEXT":2]
  If you would like to continue loading when an error is encountered, use other values such as 'SKIP_FILE' or 'CONTINUE' for the ON_ERROR option. For more information on loading options, please run 'info loading_data' in a SQL client.; 600)
[2025-10-02T06:09:55.752+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-10-02T06:09:55.762+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-02T06:09:55.763+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
